name: gremlin-http
containers:
- image: registry.centos.org/datamodel/gremlin:concaf
  command: ["/bin/sh"]
  args: ["-c", "curl -O https://raw.githubusercontent.com/containscafeine/kapp-analytics-data-model/master/new-entrypoint.sh && chmod +x new-entrypoint.sh && ./new-entrypoint.sh"]
  health:
   httpGet:
     # let's query non-existing data so we get response immediately
     path: /?gremlin=g.V().has('vertex_label','foobar').count()
     port: 8182
     scheme: HTTP
   initialDelaySeconds: 60
   periodSeconds: 60
   timeoutSeconds: 30
  env:
  - name: REST
    value: "1"
  - name: DEBUG_GRAPH_METRICS
    value: "0"
  resources:
    limits:
      memory: 2G
services:
- ports:
  - port: 8182
    targetPort: 8182
    endpoint: gremlin-http
